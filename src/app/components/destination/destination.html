<!-- Hero Section -->
<section class="page-hero">
  <div class="container">
    <h1>Explore Destinations</h1>
    <p>
      Handpicked places to inspire your next trip — beaches, mountains, culture and wild safaris.
    </p>
  </div>
</section>

<!-- Main Section -->
<main class="section">
  <div class="container">
    <!-- Controls -->
    <div class="controls dest-controls">
      <div class="search-wrap">
        <input
          type="text"
          placeholder="Search destinations (e.g. Bali, Santorini)..."
          [(ngModel)]="searchTerm"
          (input)="applyFilters()"
        />
      </div>

      <div class="filter-wrap">
        <select [(ngModel)]="selectedCountry" (change)="applyFilters()">
          <option value="">All Countries</option>
          <option *ngFor="let country of countries" [value]="country">
            {{ country }}
          </option>
        </select>

        <select [(ngModel)]="minRating" (change)="applyFilters()" title="Filter by Rating">
          <option value="">Min rating</option>
          <option value="4.9">4.9</option>
          <option value="4.8">4.8</option>
          <option value="4.7">4.7</option>
          <option value="4.6">4.6</option>
        </select>

        <select [(ngModel)]="sortOption" (change)="applyFilters()" title="Sort Destinations">
          <option value="featured">Sort: Featured</option>
          <option value="ratingHighLow">Rating: High → Low</option>
          <option value="ratingLowHigh">Rating: Low → High</option>
          <option value="nameAZ">Name A → Z</option>
          <option value="nameZA">Name Z → A</option>
        </select>

        <button (click)="clearFilters()" class="submit-btn">Clear</button>
      </div>
    </div>

    <!-- Grid -->
    <div class="destinations-grid">
      <div *ngFor="let d of filteredDestinations" class="destination-card">
        <video
          *ngIf="d.video; else showImage"
          [src]="d.video"
          autoplay
          muted
          loop
          playsinline
          class="media-video"
        ></video>

        <ng-template #showImage>
          <img [src]="d.img" [alt]="d.title" />
        </ng-template>

        <div class="package-body">
          <h3>{{ d.title }}</h3>
          <p class="location">{{ d.location }}</p>
          <p class="rating"><mat-icon>star</mat-icon> {{ d.rating }}</p>
          <p>{{ d.desc }}</p>

          <div class="actions">
            <a [routerLink]="['/booking']" [queryParams]="{ destination: d.slug }" class="book-now">Book Now</a>
            <button (click)="openDestination(d)" class="view-details">View Details</button>
          </div>
        </div>
      </div>
    </div>

  </div>
</main>

<!-- Destination Modal -->
<div class="modal" *ngIf="selectedDest">
  <div class="modal-body" role="dialog" aria-modal="true">
    <button (click)="closeDestination()" class="submit-btn close-btn">Close</button>

    <div class="modal-content">
      <h2>{{ selectedDest.title }}</h2>
      <div class="slider" *ngIf="selectedDest.images?.length">
        <button (click)="prevImage()">‹</button>
        <img [src]="selectedDest.images?.[currentImageIndex]" [alt]="selectedDest.title" />
        <button (click)="nextImage()">›</button>
      </div>
      <img
        *ngIf="!selectedDest.images?.length && selectedDest.img"
        [src]="selectedDest.img"
        [alt]="selectedDest.title"
      />
      <p><strong>Location:</strong> {{ selectedDest.location }}</p>
      <p><strong>Rating:</strong> <mat-icon>star</mat-icon> {{ selectedDest.rating }}</p>
      <p>{{ selectedDest.desc }}</p>

      <div *ngIf="selectedDest.highlights?.length" class="highlights">
        <h3>Highlights</h3>
        <ul>
          <li *ngFor="let h of selectedDest.highlights">{{ h }}</li>
        </ul>
      </div>

      <div *ngIf="selectedDest.itinerary?.length" class="itinerary">
        <h3>Itinerary</h3>
        <ul>
          <li *ngFor="let i of selectedDest.itinerary">{{ i }}</li>
        </ul>
      </div>
    </div>
  </div>
</div>
